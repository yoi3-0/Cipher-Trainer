{"ast":null,"code":"import _objectSpread from \"/Users/daniilkurpachenko/Desktop/onewayfunc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/daniilkurpachenko/Desktop/onewayfunc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/daniilkurpachenko/Desktop/onewayfunc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/daniilkurpachenko/Desktop/onewayfunc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/daniilkurpachenko/Desktop/onewayfunc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/daniilkurpachenko/Desktop/onewayfunc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/daniilkurpachenko/Desktop/onewayfunc/src/App.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { goBack, closeModal, setStory } from \"./js/store/router/actions\";\nimport { getActivePanel } from \"./js/services/_functions\";\nimport * as VK from './js/services/VK';\nimport { Epic, View, Root, Tabbar, ModalRoot, TabbarItem, ConfigProvider } from \"@vkontakte/vkui\";\nimport Icon28Newsfeed from '@vkontakte/icons/dist/28/newsfeed';\nimport Icon28More from '@vkontakte/icons/dist/28/more';\nimport HomePanelBase from './js/panels/home/base';\nimport HomePanelOneWay from './js/panels/home/oneway';\nimport HomePanelTrain from './js/panels/home/train';\nimport MorePanelBase from './js/panels/more/base';\nimport MorePanelExample from './js/panels/more/example';\nimport HomeBotsListModal from './js/components/modals/HomeBotsListModal';\nimport HomeBotInfoModal from './js/components/modals/HomeBotInfoModal';\n\nvar App = /*#__PURE__*/function (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n    _this.lastAndroidBackAction = 0;\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          goBack = _this$props.goBack,\n          dispatch = _this$props.dispatch;\n      dispatch(VK.initApp());\n\n      window.onpopstate = function () {\n        var timeNow = +new Date();\n\n        if (timeNow - _this2.lastAndroidBackAction > 500) {\n          _this2.lastAndroidBackAction = timeNow;\n          goBack();\n        } else {\n          window.history.pushState(null, null);\n        }\n      };\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      var _this$props2 = this.props,\n          activeView = _this$props2.activeView,\n          activeStory = _this$props2.activeStory,\n          activePanel = _this$props2.activePanel,\n          scrollPosition = _this$props2.scrollPosition;\n\n      if (prevProps.activeView !== activeView || prevProps.activePanel !== activePanel || prevProps.activeStory !== activeStory) {\n        var pageScrollPosition = scrollPosition[activeStory + \"_\" + activeView + \"_\" + activePanel] || 0;\n        window.scroll(0, pageScrollPosition);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          goBack = _this$props3.goBack,\n          setStory = _this$props3.setStory,\n          closeModal = _this$props3.closeModal,\n          popouts = _this$props3.popouts,\n          activeView = _this$props3.activeView,\n          activeStory = _this$props3.activeStory,\n          activeModals = _this$props3.activeModals,\n          panelsHistory = _this$props3.panelsHistory,\n          colorScheme = _this$props3.colorScheme;\n      var history = panelsHistory[activeView] === undefined ? [activeView] : panelsHistory[activeView];\n      var popout = popouts[activeView] === undefined ? null : popouts[activeView];\n      var activeModal = activeModals[activeView] === undefined ? null : activeModals[activeView];\n      var homeModals = /*#__PURE__*/React.createElement(ModalRoot, {\n        activeModal: activeModal,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(HomeBotsListModal, {\n        id: \"MODAL_PAGE_BOTS_LIST\",\n        onClose: function onClose() {\n          return closeModal();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(HomeBotInfoModal, {\n        id: \"MODAL_PAGE_BOT_INFO\",\n        onClose: function onClose() {\n          return closeModal();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 17\n        }\n      }));\n      return /*#__PURE__*/React.createElement(ConfigProvider, {\n        isWebView: true,\n        scheme: colorScheme,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Epic, {\n        activeStory: activeStory,\n        tabbar: /*#__PURE__*/React.createElement(Tabbar, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(TabbarItem, {\n          onClick: function onClick() {\n            return setStory('home', 'base');\n          },\n          selected: activeStory === 'home',\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(Icon28Newsfeed, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 26\n          }\n        })), /*#__PURE__*/React.createElement(TabbarItem, {\n          onClick: function onClick() {\n            return setStory('more', 'callmodal');\n          },\n          selected: activeStory === 'more',\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(Icon28More, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 26\n          }\n        }))),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Root, {\n        id: \"home\",\n        activeView: activeView,\n        popout: popout,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(View, {\n        id: \"home\",\n        modal: homeModals,\n        activePanel: getActivePanel(\"home\"),\n        history: history,\n        onSwipeBack: function onSwipeBack() {\n          return goBack();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(HomePanelBase, {\n        id: \"base\",\n        withoutEpic: false,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(HomePanelOneWay, {\n        id: \"oneway\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(HomePanelTrain, {\n        id: \"train\",\n        popout: popout,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 29\n        }\n      }))), /*#__PURE__*/React.createElement(Root, {\n        id: \"more\",\n        activeView: activeView,\n        popout: popout,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(View, {\n        id: \"more\",\n        modal: homeModals,\n        activePanel: getActivePanel(\"more\"),\n        history: history,\n        onSwipeBack: function onSwipeBack() {\n          return goBack();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(MorePanelBase, {\n        id: \"callmodal\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 29\n        }\n      })), /*#__PURE__*/React.createElement(View, {\n        id: \"modal\",\n        modal: homeModals,\n        activePanel: getActivePanel(\"modal\"),\n        history: history,\n        onSwipeBack: function onSwipeBack() {\n          return goBack();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(MorePanelExample, {\n        id: \"filters\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 29\n        }\n      })))));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    activeView: state.router.activeView,\n    activeStory: state.router.activeStory,\n    panelsHistory: state.router.panelsHistory,\n    activeModals: state.router.activeModals,\n    popouts: state.router.popouts,\n    scrollPosition: state.router.scrollPosition,\n    colorScheme: state.vkui.colorScheme\n  };\n};\n\nfunction mapDispatchToProps(dispatch) {\n  return _objectSpread({\n    dispatch: dispatch\n  }, bindActionCreators({\n    setStory: setStory,\n    goBack: goBack,\n    closeModal: closeModal\n  }, dispatch));\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","map":{"version":3,"sources":["/Users/daniilkurpachenko/Desktop/onewayfunc/src/App.js"],"names":["React","connect","bindActionCreators","goBack","closeModal","setStory","getActivePanel","VK","Epic","View","Root","Tabbar","ModalRoot","TabbarItem","ConfigProvider","Icon28Newsfeed","Icon28More","HomePanelBase","HomePanelOneWay","HomePanelTrain","MorePanelBase","MorePanelExample","HomeBotsListModal","HomeBotInfoModal","App","props","lastAndroidBackAction","dispatch","initApp","window","onpopstate","timeNow","Date","history","pushState","prevProps","prevState","snapshot","activeView","activeStory","activePanel","scrollPosition","pageScrollPosition","scroll","popouts","activeModals","panelsHistory","colorScheme","undefined","popout","activeModal","homeModals","Component","mapStateToProps","state","router","vkui","mapDispatchToProps"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,OAAR,QAAsB,aAAtB;AACA,SAAQC,kBAAR,QAAiC,OAAjC;AACA,SAAQC,MAAR,EAAgBC,UAAhB,EAA4BC,QAA5B,QAA2C,2BAA3C;AACA,SAAQC,cAAR,QAA6B,0BAA7B;AACA,OAAO,KAAKC,EAAZ,MAAoB,kBAApB;AAEA,SAAQC,IAAR,EAAcC,IAAd,EAAoBC,IAApB,EAA0BC,MAA1B,EAAkCC,SAAlC,EAA6CC,UAA7C,EAAyDC,cAAzD,QAA8E,iBAA9E;AAEA,OAAOC,cAAP,MAA2B,mCAA3B;AACA,OAAOC,UAAP,MAAuB,+BAAvB;AAEA,OAAOC,aAAP,MAA0B,uBAA1B;AACA,OAAOC,eAAP,MAA4B,yBAA5B;AACA,OAAOC,cAAP,MAA2B,wBAA3B;AAEA,OAAOC,aAAP,MAA0B,uBAA1B;AACA,OAAOC,gBAAP,MAA6B,0BAA7B;AAEA,OAAOC,iBAAP,MAA8B,0CAA9B;AACA,OAAOC,gBAAP,MAA6B,yCAA7B;;IAEMC,G;;;AACF,eAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACf,6EAAMA,KAAN;AAEA,UAAKC,qBAAL,GAA6B,CAA7B;AAHe;AAIlB;;;;wCAEmB;AAAA;;AAAA,wBACW,KAAKD,KADhB;AAAA,UACTtB,MADS,eACTA,MADS;AAAA,UACDwB,QADC,eACDA,QADC;AAGhBA,MAAAA,QAAQ,CAACpB,EAAE,CAACqB,OAAH,EAAD,CAAR;;AAEAC,MAAAA,MAAM,CAACC,UAAP,GAAoB,YAAM;AACtB,YAAIC,OAAO,GAAG,CAAC,IAAIC,IAAJ,EAAf;;AAEA,YAAID,OAAO,GAAG,MAAI,CAACL,qBAAf,GAAuC,GAA3C,EAAgD;AAC5C,UAAA,MAAI,CAACA,qBAAL,GAA6BK,OAA7B;AAEA5B,UAAAA,MAAM;AACT,SAJD,MAIO;AACH0B,UAAAA,MAAM,CAACI,OAAP,CAAeC,SAAf,CAAyB,IAAzB,EAA+B,IAA/B;AACH;AACJ,OAVD;AAWH;;;uCAEkBC,S,EAAWC,S,EAAWC,Q,EAAU;AAAA,yBACgB,KAAKZ,KADrB;AAAA,UACxCa,UADwC,gBACxCA,UADwC;AAAA,UAC5BC,WAD4B,gBAC5BA,WAD4B;AAAA,UACfC,WADe,gBACfA,WADe;AAAA,UACFC,cADE,gBACFA,cADE;;AAG/C,UACIN,SAAS,CAACG,UAAV,KAAyBA,UAAzB,IACAH,SAAS,CAACK,WAAV,KAA0BA,WAD1B,IAEAL,SAAS,CAACI,WAAV,KAA0BA,WAH9B,EAIE;AACE,YAAIG,kBAAkB,GAAGD,cAAc,CAACF,WAAW,GAAG,GAAd,GAAoBD,UAApB,GAAiC,GAAjC,GAAuCE,WAAxC,CAAd,IAAsE,CAA/F;AAEAX,QAAAA,MAAM,CAACc,MAAP,CAAc,CAAd,EAAiBD,kBAAjB;AACH;AACJ;;;6BAEQ;AAAA,yBAC8G,KAAKjB,KADnH;AAAA,UACEtB,MADF,gBACEA,MADF;AAAA,UACUE,QADV,gBACUA,QADV;AAAA,UACoBD,UADpB,gBACoBA,UADpB;AAAA,UACgCwC,OADhC,gBACgCA,OADhC;AAAA,UACyCN,UADzC,gBACyCA,UADzC;AAAA,UACqDC,WADrD,gBACqDA,WADrD;AAAA,UACkEM,YADlE,gBACkEA,YADlE;AAAA,UACgFC,aADhF,gBACgFA,aADhF;AAAA,UAC+FC,WAD/F,gBAC+FA,WAD/F;AAGL,UAAId,OAAO,GAAIa,aAAa,CAACR,UAAD,CAAb,KAA8BU,SAA/B,GAA4C,CAACV,UAAD,CAA5C,GAA2DQ,aAAa,CAACR,UAAD,CAAtF;AACA,UAAIW,MAAM,GAAIL,OAAO,CAACN,UAAD,CAAP,KAAwBU,SAAzB,GAAsC,IAAtC,GAA6CJ,OAAO,CAACN,UAAD,CAAjE;AACA,UAAIY,WAAW,GAAIL,YAAY,CAACP,UAAD,CAAZ,KAA6BU,SAA9B,GAA2C,IAA3C,GAAkDH,YAAY,CAACP,UAAD,CAAhF;AAEA,UAAMa,UAAU,gBACZ,oBAAC,SAAD;AAAW,QAAA,WAAW,EAAED,WAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI,oBAAC,iBAAD;AACI,QAAA,EAAE,EAAC,sBADP;AAEI,QAAA,OAAO,EAAE;AAAA,iBAAM9C,UAAU,EAAhB;AAAA,SAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,eAKI,oBAAC,gBAAD;AACI,QAAA,EAAE,EAAC,qBADP;AAEI,QAAA,OAAO,EAAE;AAAA,iBAAMA,UAAU,EAAhB;AAAA,SAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALJ,CADJ;AAaA,0BACI,oBAAC,cAAD;AAAgB,QAAA,SAAS,EAAE,IAA3B;AAAiC,QAAA,MAAM,EAAE2C,WAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI,oBAAC,IAAD;AAAM,QAAA,WAAW,EAAER,WAAnB;AAAgC,QAAA,MAAM,eAClC,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBACI,oBAAC,UAAD;AACI,UAAA,OAAO,EAAE;AAAA,mBAAMlC,QAAQ,CAAC,MAAD,EAAS,MAAT,CAAd;AAAA,WADb;AAEI,UAAA,QAAQ,EAAEkC,WAAW,KAAK,MAF9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAGC,oBAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAHD,CADJ,eAKI,oBAAC,UAAD;AACI,UAAA,OAAO,EAAE;AAAA,mBAAMlC,QAAQ,CAAC,MAAD,EAAS,WAAT,CAAd;AAAA,WADb;AAEI,UAAA,QAAQ,EAAEkC,WAAW,KAAK,MAF9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAGC,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAHD,CALJ,CADJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAYI,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAC,MAAT;AAAgB,QAAA,UAAU,EAAED,UAA5B;AAAwC,QAAA,MAAM,EAAEW,MAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI,oBAAC,IAAD;AACI,QAAA,EAAE,EAAC,MADP;AAEI,QAAA,KAAK,EAAEE,UAFX;AAGI,QAAA,WAAW,EAAE7C,cAAc,CAAC,MAAD,CAH/B;AAII,QAAA,OAAO,EAAE2B,OAJb;AAKI,QAAA,WAAW,EAAE;AAAA,iBAAM9B,MAAM,EAAZ;AAAA,SALjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAOI,oBAAC,aAAD;AAAe,QAAA,EAAE,EAAC,MAAlB;AAAyB,QAAA,WAAW,EAAE,KAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPJ,eAQI,oBAAC,eAAD;AAAiB,QAAA,EAAE,EAAC,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QARJ,eASI,oBAAC,cAAD;AAAgB,QAAA,EAAE,EAAC,OAAnB;AAA2B,QAAA,MAAM,EAAE8C,MAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QATJ,CADJ,CAZJ,eAyBI,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAC,MAAT;AAAgB,QAAA,UAAU,EAAEX,UAA5B;AAAwC,QAAA,MAAM,EAAEW,MAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI,oBAAC,IAAD;AACI,QAAA,EAAE,EAAC,MADP;AAEI,QAAA,KAAK,EAAEE,UAFX;AAGI,QAAA,WAAW,EAAE7C,cAAc,CAAC,MAAD,CAH/B;AAII,QAAA,OAAO,EAAE2B,OAJb;AAKI,QAAA,WAAW,EAAE;AAAA,iBAAM9B,MAAM,EAAZ;AAAA,SALjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAOI,oBAAC,aAAD;AAAe,QAAA,EAAE,EAAC,WAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPJ,CADJ,eAUI,oBAAC,IAAD;AACI,QAAA,EAAE,EAAC,OADP;AAEI,QAAA,KAAK,EAAEgD,UAFX;AAGI,QAAA,WAAW,EAAE7C,cAAc,CAAC,OAAD,CAH/B;AAII,QAAA,OAAO,EAAE2B,OAJb;AAKI,QAAA,WAAW,EAAE;AAAA,iBAAM9B,MAAM,EAAZ;AAAA,SALjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAOI,oBAAC,gBAAD;AAAkB,QAAA,EAAE,EAAC,SAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPJ,CAVJ,CAzBJ,CADJ,CADJ;AAkDH;;;;EA7GaH,KAAK,CAACoD,S;;AAgHxB,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,KAAD,EAAW;AAC/B,SAAO;AACHhB,IAAAA,UAAU,EAAEgB,KAAK,CAACC,MAAN,CAAajB,UADtB;AAEHC,IAAAA,WAAW,EAAEe,KAAK,CAACC,MAAN,CAAahB,WAFvB;AAGHO,IAAAA,aAAa,EAAEQ,KAAK,CAACC,MAAN,CAAaT,aAHzB;AAIHD,IAAAA,YAAY,EAAES,KAAK,CAACC,MAAN,CAAaV,YAJxB;AAKHD,IAAAA,OAAO,EAAEU,KAAK,CAACC,MAAN,CAAaX,OALnB;AAMHH,IAAAA,cAAc,EAAEa,KAAK,CAACC,MAAN,CAAad,cAN1B;AAQHM,IAAAA,WAAW,EAAEO,KAAK,CAACE,IAAN,CAAWT;AARrB,GAAP;AAUH,CAXD;;AAcA,SAASU,kBAAT,CAA4B9B,QAA5B,EAAsC;AAClC;AACIA,IAAAA,QAAQ,EAARA;AADJ,KAEOzB,kBAAkB,CAAC;AAACG,IAAAA,QAAQ,EAARA,QAAD;AAAWF,IAAAA,MAAM,EAANA,MAAX;AAAmBC,IAAAA,UAAU,EAAVA;AAAnB,GAAD,EAAiCuB,QAAjC,CAFzB;AAIH;;AAED,eAAe1B,OAAO,CAACoD,eAAD,EAAkBI,kBAAlB,CAAP,CAA6CjC,GAA7C,CAAf","sourcesContent":["import React from 'react';\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux'\nimport {goBack, closeModal, setStory} from \"./js/store/router/actions\";\nimport {getActivePanel} from \"./js/services/_functions\";\nimport * as VK from './js/services/VK';\n\nimport {Epic, View, Root, Tabbar, ModalRoot, TabbarItem, ConfigProvider} from \"@vkontakte/vkui\";\n\nimport Icon28Newsfeed from '@vkontakte/icons/dist/28/newsfeed';\nimport Icon28More from '@vkontakte/icons/dist/28/more';\n\nimport HomePanelBase from './js/panels/home/base';\nimport HomePanelOneWay from './js/panels/home/oneway';\nimport HomePanelTrain from './js/panels/home/train'\n\nimport MorePanelBase from './js/panels/more/base';\nimport MorePanelExample from './js/panels/more/example';\n\nimport HomeBotsListModal from './js/components/modals/HomeBotsListModal';\nimport HomeBotInfoModal from './js/components/modals/HomeBotInfoModal';\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.lastAndroidBackAction = 0;\n    }\n\n    componentDidMount() {\n        const {goBack, dispatch} = this.props;\n\n        dispatch(VK.initApp());\n\n        window.onpopstate = () => {\n            let timeNow = +new Date();\n\n            if (timeNow - this.lastAndroidBackAction > 500) {\n                this.lastAndroidBackAction = timeNow;\n\n                goBack();\n            } else {\n                window.history.pushState(null, null);\n            }\n        };\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        const {activeView, activeStory, activePanel, scrollPosition} = this.props;\n\n        if (\n            prevProps.activeView !== activeView ||\n            prevProps.activePanel !== activePanel ||\n            prevProps.activeStory !== activeStory\n        ) {\n            let pageScrollPosition = scrollPosition[activeStory + \"_\" + activeView + \"_\" + activePanel] || 0;\n\n            window.scroll(0, pageScrollPosition);\n        }\n    }\n\n    render() {\n        const {goBack, setStory, closeModal, popouts, activeView, activeStory, activeModals, panelsHistory, colorScheme} = this.props;\n\n        let history = (panelsHistory[activeView] === undefined) ? [activeView] : panelsHistory[activeView];\n        let popout = (popouts[activeView] === undefined) ? null : popouts[activeView];\n        let activeModal = (activeModals[activeView] === undefined) ? null : activeModals[activeView];\n\n        const homeModals = (\n            <ModalRoot activeModal={activeModal}>\n                <HomeBotsListModal\n                    id=\"MODAL_PAGE_BOTS_LIST\"\n                    onClose={() => closeModal()}\n                />\n                <HomeBotInfoModal\n                    id=\"MODAL_PAGE_BOT_INFO\"\n                    onClose={() => closeModal()}\n                />\n            </ModalRoot>\n        );\n\n        return (\n            <ConfigProvider isWebView={true} scheme={colorScheme}>\n                <Epic activeStory={activeStory} tabbar={\n                    <Tabbar>\n                        <TabbarItem\n                            onClick={() => setStory('home', 'base')}\n                            selected={activeStory === 'home'}\n                        ><Icon28Newsfeed/></TabbarItem>\n                        <TabbarItem\n                            onClick={() => setStory('more', 'callmodal')}\n                            selected={activeStory === 'more'}\n                        ><Icon28More/></TabbarItem>\n                    </Tabbar>\n                }>\n                    <Root id=\"home\" activeView={activeView} popout={popout}>\n                        <View\n                            id=\"home\"\n                            modal={homeModals}\n                            activePanel={getActivePanel(\"home\")}\n                            history={history}\n                            onSwipeBack={() => goBack()}\n                        >\n                            <HomePanelBase id=\"base\" withoutEpic={false}/>\n                            <HomePanelOneWay id=\"oneway\"/>\n                            <HomePanelTrain id=\"train\" popout={popout}/>\n                        </View>\n                    </Root>\n                    <Root id=\"more\" activeView={activeView} popout={popout}>\n                        <View\n                            id=\"more\"\n                            modal={homeModals}\n                            activePanel={getActivePanel(\"more\")}\n                            history={history}\n                            onSwipeBack={() => goBack()}\n                        >\n                            <MorePanelBase id=\"callmodal\"/>\n                        </View>\n                        <View\n                            id=\"modal\"\n                            modal={homeModals}\n                            activePanel={getActivePanel(\"modal\")}\n                            history={history}\n                            onSwipeBack={() => goBack()}\n                        >\n                            <MorePanelExample id=\"filters\"/>\n                        </View>\n                    </Root>\n                </Epic>\n            </ConfigProvider>\n        );\n    }\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        activeView: state.router.activeView,\n        activeStory: state.router.activeStory,\n        panelsHistory: state.router.panelsHistory,\n        activeModals: state.router.activeModals,\n        popouts: state.router.popouts,\n        scrollPosition: state.router.scrollPosition,\n\n        colorScheme: state.vkui.colorScheme\n    };\n};\n\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        dispatch,\n        ...bindActionCreators({setStory, goBack, closeModal}, dispatch)\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"]},"metadata":{},"sourceType":"module"}